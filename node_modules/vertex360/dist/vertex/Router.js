"use strict";var _prototypeProperties=function(t,e,r){e&&Object.defineProperties(t,e),r&&Object.defineProperties(t.prototype,r)},_classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Promise=require("bluebird"),routeMap=require("route-map"),Router=function(){function t(){_classCallCheck(this,t),this.stem=null,this.getHandler={routeMatcher:null,routes:{}},this.postHandler={routeMatcher:null,routes:{}},this.putHandler={routeMatcher:null,routes:{}},this.deleteHandler={routeMatcher:null,routes:{}}}return _prototypeProperties(t,null,{setStem:{value:function(t){this.stem=t},writable:!0,configurable:!0},parseRoute:{value:function(t){var e="/"==t.path?"/":t.path.replace(this.stem,"");if(0==e.length&&(e="/"),e.length>1){var r=e.length-1;"/"==e[r]&&(e=e.substring(0,r))}return e},writable:!0,configurable:!0},matchRoute:{value:function(t,e){var r=null;if("get"==e&&(r=this.getHandler.routeMatcher),"post"==e&&(r=this.postHandler.routeMatcher),"put"==e&&(r=this.putHandler.routeMatcher),"delete"==e&&(r=this.deleteHandler.routeMatcher),null==r)return null;var u=r(t);if(void 0==u)return null;var a=u.fn;return null==a?null:{routeHandler:a,routeParams:u}},writable:!0,configurable:!0},get:{value:function(t,e){this.getHandler.routes[t]=e,this.getHandler.routeMatcher=routeMap(this.getHandler.routes)},writable:!0,configurable:!0},handleGet:{value:function(t){return"/"==this.stem?this.matchRoute(t.path,"get"):t.path.substring(0,this.stem.length)!=this.stem?null:this.matchRoute(this.parseRoute(t),"get")},writable:!0,configurable:!0},post:{value:function(t,e){this.postHandler.routes[t]=e,this.postHandler.routeMatcher=routeMap(this.postHandler.routes)},writable:!0,configurable:!0},handlePost:{value:function(t){return"/"==this.stem?this.matchRoute(t.path,"post"):t.path.substring(0,this.stem.length)!=this.stem?null:this.matchRoute(this.parseRoute(t),"post")},writable:!0,configurable:!0},put:{value:function(t,e){this.putHandler.routes[t]=e,this.putHandler.routeMatcher=routeMap(this.putHandler.routes)},writable:!0,configurable:!0},handlePut:{value:function(t){return"/"==this.stem?this.matchRoute(t.path,"put"):t.path.substring(0,this.stem.length)!=this.stem?null:this.matchRoute(this.parseRoute(t),"put")},writable:!0,configurable:!0},delete:{value:function(t,e){this.deleteHandler.routes[t]=e,this.deleteHandler.routeMatcher=routeMap(this.deleteHandler.routes)},writable:!0,configurable:!0},handleDelete:{value:function(t){return"/"==this.stem?this.matchRoute(t.path,"delete"):t.path.substring(0,this.stem.length)!=this.stem?null:this.matchRoute(this.parseRoute(t),"delete")},writable:!0,configurable:!0}}),t}();module.exports=Router;
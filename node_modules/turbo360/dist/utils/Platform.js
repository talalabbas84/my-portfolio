var Promise=require("bluebird"),superagent=require("superagent"),helper=require("./Helper"),Platform=function(e){var r=e,t=function(){return new Promise(function(e,t){return null==r.site_id?void t(new Error("Please Set Your TURBO_APP_ID")):r.site_id.length<20?void t(new Error("Please Set Your TURBO_APP_ID")):void helper.fetchSite(r).then(function(r){e(r)}).catch(function(e){t(e)})})};return{site:function(){return new Promise(function(e,t){if(null==r.site_id)return void t(new Error("Please Set Your TURBO_APP_ID"));if(r.site_id.length<20)return void t(new Error("Please Set Your TURBO_APP_ID"));var n=r.turbo_url+"/api/site/"+r.site_id;superagent.get(n).query(null).set("Accept","application/json").end(function(r,n){if(r)return void t(r);var i=n.body;if("success"!=i.confirmation)return void t(new Error(i.message));e(i.result)})})},currentSite:t,fetchSites:function(e){return new Promise(function(t,n){if(null==r.site_id)return void n(new Error("Please Set Your TURBO_APP_ID"));if(r.site_id.length<20)return void n(new Error("Please Set Your TURBO_APP_ID"));var i=r.turbo_url+"/api/site";superagent.get(i).query(e).set("Accept","application/json").end(function(e,r){if(e)return void n(e);var i=r.body;if("success"!=i.confirmation)return void n(new Error(i.message));var o=i.results||i.result;t(o)})})}}};module.exports=Platform;